apiVersion: v1
kind: List
items:
  - apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: jaeger
      labels:
        app: jaeger
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
        app.kubernetes.io/part-of: tracing
    spec:
      selector:
        matchLabels:
          app: jaeger
      replicas: 1
      strategy:
        type: Recreate
      template:
        metadata:
          labels:
            app: jaeger
            app.kubernetes.io/name: jaeger
            app.kubernetes.io/component: all-in-one
          annotations:
            prometheus.io/scrape: "true"
            prometheus.io/port: "16686"
        spec:
          containers:
            - env:
                - name: COLLECTOR_ZIPKIN_HTTP_PORT
                  value: "9411"
              image: registry.redhat.io/rhosdt/jaeger-all-in-one-rhel8
              name: jaeger
              ports:
                - containerPort: 5775
                  protocol: UDP
                - containerPort: 6831
                  protocol: UDP
                - containerPort: 6832
                  protocol: UDP
                - containerPort: 5778
                  protocol: TCP
                - containerPort: 16685
                  protocol: UDP
                - containerPort: 16686
                  protocol: TCP
                - containerPort: 9411
                  protocol: TCP
                - containerPort: 14250
                  protocol: TCP
                - containerPort: 14268
                  protocol: TCP
                - containerPort: 14269
                  protocol: TCP
                - containerPort: 4317
                  protocol: TCP
                - containerPort: 4318
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: "/"
                  port: 14269
                initialDelaySeconds: 5
  - apiVersion: v1
    kind: Service
    metadata:
      name: jaeger-query
      labels:
        app: jaeger
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: query
    spec:
      ports:
        - name: query-http
          port: 443
          protocol: TCP
          targetPort: 16686
        - name: admin-http
          port: 16687
          protocol: TCP
          targetPort: 16687
        - name: query-grpc
          port: 16685
          protocol: UDP
          targetPort: 16685
      selector:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
  - apiVersion: v1
    kind: Service
    metadata:
      name: jaeger-collector
      labels:
        app: jaeger
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: collector
    spec:
      ports:
        - name: jaeger-collector-tchannel
          port: 14267
          protocol: TCP
          targetPort: 14267
        - name: tls-grpc-jaeger
          port: 14250
          protocol: TCP
          targetPort: 14250
        - name: jaeger-collector-http
          port: 14268
          protocol: TCP
          targetPort: 14268
        - name: jaeger-collector-zipkin
          port: 9411
          protocol: TCP
          targetPort: 9411
        - name: grpc-otlp
          port: 4317
          protocol: TCP
          targetPort: 4317
        - name: http-otlp
          port: 4318
          protocol: TCP
          targetPort: 4318
        - name: admin-http
          port: 14269
          protocol: TCP
          targetPort: 14269
      selector:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
      type: ClusterIP
  - apiVersion: v1
    kind: Service
    metadata:
      name: jaeger-agent
      labels:
        app: jaeger
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: agent
    spec:
      ports:
        - name: agent-zipkin-thrift
          port: 5775
          protocol: UDP
          targetPort: 5775
        - name: agent-compact
          port: 6831
          protocol: UDP
          targetPort: 6831
        - name: agent-binary
          port: 6832
          protocol: UDP
          targetPort: 6832
        - name: agent-configs
          port: 5778
          protocol: TCP
          targetPort: 5778
        - name: admin-http
          port: 14271
          protocol: TCP
          targetPort: 14271
      clusterIP: None
      selector:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
  - apiVersion: v1
    kind: Service
    metadata:
      name: zipkin
      labels:
        app: jaeger
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: zipkin
    spec:
      ports:
        - name: jaeger-collector-zipkin
          port: 9411
          protocol: TCP
          targetPort: 9411
      type: ClusterIP
      selector:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
  - apiVersion: route.openshift.io/v1
    kind: Route
    metadata:
      name: jaeger
      labels:
        app: jaeger
        app.kubernetes.io/component: query
        app.kubernetes.io/name: jaeger
    spec:
      to:
        kind: Service
        name: jaeger-query
        weight: 100
      port:
        targetPort: query-http
      tls:
        termination: edge
      wildcardPolicy: None
      selector:
        app.kubernetes.io/name: jaeger
        app.kubernetes.io/component: all-in-one
